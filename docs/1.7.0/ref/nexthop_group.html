
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>nexthop_group &mdash; Arista EOS SDK 1.7.0 reference</title>
    
    <link rel="stylesheet" href="_static/eossdk.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/breathe.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Arista EOS SDK 1.7.0 reference" href="index.html" />
    <link rel="next" title="panic" href="panic.html" />
    <link rel="prev" title="neighbor_table" href="neighbor_table.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="panic.html" title="panic"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="neighbor_table.html" title="neighbor_table"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Arista EOS SDK 1.7.0 reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="nexthop-group">
<h1><strong>nexthop_group</strong><a class="headerlink" href="#nexthop-group" title="Permalink to this headline">¶</a></h1>
<p>Nexthop groups are a forwarding/tunneling abstraction in EOS.</p>
<p>A nexthop group is comprised of a tunneling protocol (IP/GRE or MPLS, for example) and a collection of nexthop (aka destination) IP addresses and other forwarding information (such as MPLS stack operations to apply for traffic sent to that nexthop). The same IP address may be specified in more than one entry within the group, allowing for unequal cost load balancing. By using distinct addresses for each entry, equal cost load balancing can be achieved.</p>
<p>The nexthop or destination IP is the tunnel (outer) destination IP address for GRE and IP-in-IP. For MPLS, the nexthop address is used to find (via ARP/ND) a MAC address for the MPLS next hop.</p>
<p>Nexthop entries must be manually monitored and maintained by the agent. If a tunnel destination (aka nexthop) becomes unreachable, traffic hashed to that entry will be black-holed in the network until a working entry is set in that index of the nexthop group, or the entry is deleted.</p>
<p>Presently, all nexthop groups encapsulate traffic directed to them, either as an IP-in-IP (IP protocol 4) tunnel, a GRE (IP protocol 47) tunnel encapsulating either IPv4, IPv6 or MPLS traffic, or as pure MPLS frames. MPLS label switching operations are also supported, see the nexthop_group_entry_t class for more information.</p>
<p>Presently, MPLS switching actions are only only supported when used with PBR and cannot be used with IP routes.</p>
<p>The following example creates a nexthop group called &#8220;nhg1&#8221; which performs GRE encapsulation of traffic sent to it, sending traffic to two different nexthop IP addresses unequally (at a 2/3 to 1/3 ratio). For a usage of a nexthop group with policy routing, see the policy_map.h file.</p>
<p> <pre class="literal-block">
   eos::nexthop_group_t nhg(&quot;nhg1&quot;, eos::NEXTHOP_GROUP_GRE);
   // Specify two destinations (nexthop group entries) for the traffic
   eos::nexthop_group_entry_t nhe1(eos::ip_addr_t(&quot;172.12.1.1&quot;));
   eos::nexthop_group_entry_t nhe2(eos::ip_addr_t(&quot;172.12.1.2&quot;));
   // Set the nexthop group entries on the group with unequal cost load balancing
   // Balance traffic 2/3 to 172.12.1.1, 1/3 to 172.12.1.2.
   nhg.nexthop_set(0, nhe1);
   nhg.nexthop_set(1, nhe1);
   nhg.nexthop_set(2, nhe2);
</pre>
</p>
<dl class="namespace">
<dt>
<span class="target" id="eossdknamespaceeos"></span><em>namespace</em> <tt class="descname">eos</tt></dt>
<dd><dl class="class">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__handler"></span><em>class</em> <tt class="descname">nexthop_group_handler</tt></dt>
<dd><em>#include &lt;nexthop_group.h&gt;</em><p>This class handles changes to a nexthop group&#8217;s status. </p>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__handler_1a812d2fd53d4ecb11ecd59f069eb10101"></span><tt class="descname">nexthop_group_handler</tt><big>(</big><a class="reference internal" href="#eossdkclasseos_1_1nexthop__group__mgr"><em>nexthop_group_mgr</em></a> *<big>)</big></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__handler_1afac72cdb6e18d31db7c626d94bae1ef2"></span><a class="reference internal" href="#eossdkclasseos_1_1nexthop__group__mgr"><em>nexthop_group_mgr</em></a> * <tt class="descname">get_nexthop_group_mgr</tt><big>(</big><big>)</big> const</dt>
<dd></dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__handler_1a06648c64f49c7db1c1862cf02d26a63c"></span>void <tt class="descname">watch_all_nexthop_groups</tt><big>(</big>bool<big>)</big></dt>
<dd><p>Registers this class to receive change updates on all nexthop groups.</p>
<p>Expects a boolean signifying whether notifications should be propagated to this instance or not. </p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__handler_1ab52e4a77a231fd62abc2692bab79406c"></span>void <tt class="descname">watch_nexthop_group</tt><big>(</big>std::string const &amp; <em>nexthop_group_name</em>, bool<big>)</big></dt>
<dd><p>Registers this class to receive change updates on the given nexthop group.</p>
<p>Expects the name of the corresponding nexthop group and a boolean signifying whether notifications should be propagated to this instance or not. </p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__handler_1a77feba081dffb352dcf54ac79cbe8141"></span>virtual void <tt class="descname">on_nexthop_group_active</tt><big>(</big>std::string const &amp; <em>nexthop_group_name</em>, bool <em>active</em><big>)</big></dt>
<dd><p>Handler called when the active status of a nexthop_group changes. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__iter__t"></span><em>class</em> <tt class="descname">nexthop_group_iter_t</tt></dt>
<dd><div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Private Functions</p>
<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__iter__t_1a52fcf6dba61fa24ebfba56d11ece5e0e"></span><tt class="descname">nexthop_group_iter_t</tt><big>(</big>nexthop_group_iter_impl * <em>const</em><big>)</big></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Friends</p>
<dl class="friend">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__iter__t_1ad05f411fce498237dd425063db19de9f"></span>friend class <tt class="descname">nexthop_group_iter_impl</tt></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="class">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr"></span><em>class</em> <tt class="descname">nexthop_group_mgr</tt></dt>
<dd><em>#include &lt;nexthop_group.h&gt;</em><p>A manager of &#8216;nexthop-group&#8217; configurations.</p>
<p>Create one of these via an sdk object prior to starting the agent main loop. When your <a class="reference internal" href="agent.html#eossdkclasseos_1_1agent__handler_1ad558b16ee9a283bd9b153400743c4b1c"><em>eos::agent_handler::on_initialized</em></a> virtual function is called, the manager is valid for use. </p>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a37828552f20babf3c11c9b5f7a85c30e"></span>virtual <tt class="descname">~nexthop_group_mgr</tt><big>(</big><big>)</big></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1af51ae749aacff2920fa29240f99e411a"></span>virtual void <tt class="descname">resync_init</tt><big>(</big><big>)</big> = 0</dt>
<dd></dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a0753783cad6e367350846ed6cda71dd3"></span>virtual void <tt class="descname">resync_complete</tt><big>(</big><big>)</big> = 0</dt>
<dd></dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a0448c7647348bf67657472d4952afcf3"></span>virtual <a class="reference internal" href="#eossdkclasseos_1_1nexthop__group__iter__t"><em>nexthop_group_iter_t</em></a> <tt class="descname">nexthop_group_iter</tt><big>(</big><big>)</big> const = 0</dt>
<dd><p>Iterates over all the nexthop groups currently configured. </p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a7e1fb0130df5c161696c67147975882b"></span>virtual nexthop_group_t <tt class="descname">nexthop_group</tt><big>(</big>std::string const &amp; <em>nexthop_group_name</em><big>)</big> const = 0</dt>
<dd><p>Retrieves an existing nexthop_group_t by name, if it exists. Otherwise this returns an empty `nexthop_group_t()` </p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a494c94b733f21cdf88008e3bf8483163"></span>virtual nexthop_group_entry_counter_t <tt class="descname">counter</tt><big>(</big>std::string const &amp; <em>nexthop_group_name</em>, uint16_t <em>entry</em><big>)</big> const = 0</dt>
<dd><p>Returns the counter corresponding to the given nexthop group name and entry, if it exists. Otherwise this returns an empty &#8216;nexthop_group_entry_counter_t()&#8217;</p>
<p>Counters are reset whenever nexthop group entry configuration changes. </p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a1b04c643b557e3254f74f0f160d09b8e"></span>virtual bool <tt class="descname">exists</tt><big>(</big>std::string const &amp; <em>nexthop_group_name</em><big>)</big> const = 0</dt>
<dd><p>Returns true if a nexthop group with the given name has been configured. </p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1af69675c2dd4e52b3fa55f18ea58f3e44"></span>virtual bool <tt class="descname">active</tt><big>(</big>std::string const &amp; <em>nexthop_group_name</em><big>)</big> const = 0</dt>
<dd><p>Returns whether or not the given nexthop group is active.</p>
<p>Nexthop groups are active if the FIB has prefixes using this group. Deleting an active nexthop group will cause all prefixes that point to that nexthop group to blackhole their traffic.</p>
<p>In order to hitlessly delete a nexthop group, first delete all prefixes that point to it, wait for the nexthop group to no longer be active (using <a class="reference internal" href="#eossdkclasseos_1_1nexthop__group__handler_1a77feba081dffb352dcf54ac79cbe8141"><em>nexthop_group_handler::on_nexthop_group_active</em></a>), and then delete the nexthop group. </p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a72892109f3262f1c0b31124ab8d517d4"></span>virtual void <tt class="descname">nexthop_group_set</tt><big>(</big>nexthop_group_t const &amp;<big>)</big> = 0</dt>
<dd><p>Creates or updates a nexthop group. </p>
</dd></dl>

<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a608cc8d6621f40779281d5ee87ca88e0"></span>virtual void <tt class="descname">nexthop_group_del</tt><big>(</big>std::string const &amp; <em>nexthop_group_name</em><big>)</big> = 0</dt>
<dd><p>Removes the named nexthop group from the configuration if it exists. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Protected Functions</p>
<dl class="function">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1ab81cf47efc619bf9f8b4ec1abcf5a1cc"></span><tt class="descname">nexthop_group_mgr</tt><big>(</big><big>)</big></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Private Members</p>
<dl class="variable">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a8e35e3264aff34acc1fcad7aa88c2ec6"></span><tt class="descname">nexthop_group_mgr</tt></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef container">
<p class="breathe-sectiondef-title rubric">Friends</p>
<dl class="friend">
<dt>
<span class="target" id="eossdkclasseos_1_1nexthop__group__mgr_1a1f65fc8b1251d23fef20a58ecf13beb5"></span>friend class <tt class="descname">nexthop_group_handler</tt></dt>
<dd></dd></dl>

</div>
</dd></dl>

</dd></dl>

<div class="section" id="type-definitions-in-nexthop-group">
<h2>Type definitions in <strong>nexthop_group</strong><a class="headerlink" href="#type-definitions-in-nexthop-group" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">doxygenfile: Found multiple matches for file &#8220;eos/types/nexthop_group.h </p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><strong>nexthop_group</strong></a><ul>
<li><a class="reference internal" href="#type-definitions-in-nexthop-group">Type definitions in <strong>nexthop_group</strong></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="neighbor_table.html"
                        title="previous chapter"><strong>neighbor_table</strong></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="panic.html"
                        title="next chapter"><strong>panic</strong></a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="panic.html" title="panic"
             >next</a> |</li>
        <li class="right" >
          <a href="neighbor_table.html" title="neighbor_table"
             >previous</a> |</li>
        <li><a href="index.html">Arista EOS SDK 1.7.0 reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Arista Networks.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>